<% layout('layout') %>

<style>
    input {
        min-height: 42px;
    }
</style>

<div class="height bgSoft padding10 borderRadius15 relative">
    <a href="/hshView/<%= householdId %>" class="nav absolute left20 top20"><i class="fas fa-chevron-left"></i>Go Back</a>    
    <div class="height100 blockX overflow-y1 padding10 borderRadius15">
        <div class="">
            <form id="residentForm" action="/add-family" method="POST" class="height0 width80">
                <div class="gap10 justifyStart alignStart">
                    <div class="height0 col justifyStart alignStart">
                        <p class="size30 str500 colorPrimary">ADD FAMILY HEAD</p>
                        <p class="size10">Please provide the details of the Family Head to create a new family. The Family Head is required before adding other members.</p>
                        <br>
                        <input type="text" class="hidden" name="householdId" value="<%= householdId %>" hidden>
                        <div class="height0 col gap5 alignStart">
                            <label for="">First Name</label>
                            <input type="text" name="firstName" required>
                        </div>
                        <div class="height0 col gap5 alignStart">
                            <label for="">Middle Name</label>
                            <input type="text" name="middleName">
                        </div>
                        <div class="height0 col gap5 alignStart">
                            <label for="">Last Name</label>
                            <input type="text" name="lastName" required>
                        </div>
                        <div class="height0 col gap5 alignStart width30">
                            <label for="">Ext Name</label>
                            <input type="text" name="extName">
                        </div>
                        <br>
                        <label for="">Birthday</label>
                        <div class="height0 gap5">
                            <div class="height0 col alignStart width40">
                                <div class="selectBar widthMax100"> 
                                    <select id="bMonth" required name="bMonth"  placeholder="Month">
                                        <option value="" selected disabled>Month</option>
                                        <option value="1">January</option>
                                        <option value="2">February</option>
                                        <option value="3">March</option>
                                        <option value="4">April</option>
                                        <option value="5">May</option>
                                        <option value="6">June</option>
                                        <option value="7">July</option>
                                        <option value="8">August</option>
                                        <option value="9">September</option>
                                        <option value="10">October</option>
                                        <option value="11">November</option>
                                        <option value="12">December</option>
                                    </select>
                                </div>
                            </div>
                            <div class="height0 col alignStart width20">
                                <input name="bDay" type="number" id="bDay" min="1" max="31" placeholder="Day" required>
                            </div>
                            <div class="height0 col alignStart width40">
                                <input name="bYear" type="number" id="bYear" min="1900" max="2024" placeholder="Year" required>
                            </div>
                        </div>
                        <label id="ageWarning" style="color: red; display: none;">Family Head can't be a minor</label>
                        <br>
                        <div class="height0 col alignStart">
                            <label for="">Birth Place</label>
                            <div class="selectBar widthMin100">
                                <select name="birthPlace" id="birthPlace" required>
                                    <option value="">--Select City--</option>
                                </select>
                                
                                <script>
                                    // Array of Philippine cities
                                    const cities = [
                                        "Alaminos", "Angeles", "Antipolo", "Bacolod", "Bacoor", "Bago", "Baguio",
                                        "Bais", "Balanga", "Batac", "Batangas City", "Bayawan", "Baybay", "Bayugan",
                                        "Biñan", "Bislig", "Bogo", "Borongan", "Bulacan", "Butuan", "Cabadbaran",
                                        "Cabanatuan", "Cabuyao", "Cadiz", "Cagayan de Oro", "Calaca", "Calamba",
                                        "Calapan", "Calbayog", "Caloocan", "Candon", "Canlaon", "Carcar", "Carmona",
                                        "Catbalogan", "Cauayan", "Cavite City", "Cebu City", "Cotabato City",
                                        "Dagupan", "Danao", "Dapitan", "Dasmariñas", "Davao City", "Digos",
                                        "Dipolog", "Dumaguete", "El Salvador", "Escalante", "Gapan", "General Santos",
                                        "General Trias", "Gingoog", "Guihulngan", "Himamaylan", "Ilagan", "Iligan",
                                        "Iloilo City", "Imus", "Iriga", "Isabela", "Kabankalan", "Kidapawan",
                                        "Koronadal", "La Carlota", "Lamitan", "Laoag", "Lapu-Lapu", "Las Piñas",
                                        "Legazpi", "Ligao", "Lipa", "Lucena", "Maasin", "Mabalacat", "Makati",
                                        "Malabon", "Malaybalay", "Malolos", "Mandaluyong", "Mandaue", "Manila",
                                        "Marawi", "Marikina", "Masbate City", "Mati", "Meycauayan", "Muñoz",
                                        "Muntinlupa", "Naga", "Navotas", "Olongapo", "Ormoc", "Oroquieta", "Ozamiz",
                                        "Pagadian", "Palayan", "Panabo", "Parañaque", "Pasay", "Pasig", "Passi",
                                        "Puerto Princesa", "Quezon City", "Roxas", "Sagay", "Samal", "San Carlos",
                                        "San Fernando", "San Jose", "San Jose del Monte", "San Pablo", "San Pedro",
                                        "Santa Rosa", "Santo Tomas", "Santiago", "Silay", "Sipalay", "Sorsogon City",
                                        "Surigao City", "Tabaco", "Tabuk", "Tacloban", "Tacurong", "Tagaytay",
                                        "Tagbilaran", "Taguig", "Tagum", "Talisay", "Tanauan", "Tandag", "Tangub",
                                        "Tanjay", "Tarlac City", "Tayabas", "Toledo", "Trece Martires", "Tuguegarao",
                                        "Urdaneta", "Valencia", "Valenzuela", "Victorias", "Vigan", "Zamboanga City"
                                    ];
                                
                                    // Get the select element
                                    const birthPlaceSelect = document.getElementById("birthPlace");
                                
                                    // Loop through the cities array and add options dynamically
                                    cities.forEach(city => {
                                        let option = document.createElement("option");
                                        option.value = city;
                                        option.textContent = city;
                                        birthPlaceSelect.appendChild(option);
                                    });
                                </script>                                
                            </div>
                        </div>
                    </div>
                    <div class="height0 col">
                        <div class="height0 gap10">
                            <div class="height0 col alignStart">
                                <label for="">Gender</label>
                                <div class="selectBar">
                                    <select id="gender" name="gender" required>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                    </select>
                                </div>
                            </div>
                            <div class="height0 col alignStart">
                                <label for="">Civil Status</label>
                                <div class="selectBar">
                                    <select name="civilStatus" required>
                                        <option value="Single">Single</option>
                                        <option value="Married">Married</option>
                                        <option value="Widowed">Widowed</option>
                                        <option value="Separated">Separated</option>
                                    </select>
                                </div>
                            </div>
                            <div class="height0 col alignStart">
                                <label for="">Precinct</label>
                                <div class="selectBar">
                                    <select name="precinct" required>
                                        <option value="Non-Voter">Non-Voter</option>
                                        <option value="Registered Vote">Registered Voter</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <br>
                        <div class="height0 gap10">
                            <div class="height0 col justifyStart alignStart">
                                <label for="">Phone</label>
                                <input type="text" name="phone" class="phone">
                            </div>
                            <div class="height0 col justifyStart alignStart">
                                <label for="">Email</label>
                                <input type="email" name="email">
                            </div>
                        </div>
                        <br>
                        <div class="height0 gap10">
                            <div class="height0 justifyStart gap10 bgSoft paddingInline10 borderRadius10">
                                <input type="checkbox" name="soloParent"><label for="">Solo Parent (Optional) </label>
                            </div>
                            <div class="height0 justifyStart gap10 bgSoft paddingInline10 borderRadius10"  id="pregnantLabel" style="display: none;">
                                <input type="checkbox" name="pregnant"><label for="">Pregnant (Optional) </label>
                            </div>
                        </div>
                        <br>
                        <div class="height0 gap10 bgSoft borderRadius10 paddingBlock5">
                            <div class="height0 justifyStart gap10 paddingInline10">
                                <input type="checkbox" id="pwdCheckbox" name="pwd"><label for="">PWD (Optional) </label>
                            </div>
                            <div class="height0 col alignStart">
                                <div class="selectBar">
                                    <select id="pwdType" name="pwdType" disabled>
                                        <option value="" selected disabled>Select Disability Type</option>
                                        <option value="Visual">Visual</option>
                                        <option value="Hearing">Hearing</option>
                                        <option value="Mobility">Mobility</option>
                                        <option value="Mental">Mental</option>
                                        <option value="Speech">Speech</option>
                                        <option value="Intellectual">Intellectual</option>
                                        <option value="Psychosocial">Psychosocial</option>
                                        <option value="Learning">Learning</option>
                                        <option value="Multiple">Multiple Disabilities</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <br>
                        <div class="height0 gap10">
                            <div class="height0 col gap5 alignStart">
                                <label for="">Employment Status</label>
                                <div class="selectBar"> 
                                    <select id="employmentStatus" name="employmentStatus" required>
                                        <option value="Unemployed">Unemployed</option>
                                        <option value="Employed">Employed</option>
                                        <option value="Self-Employed">Self-Employed</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="height0 gap10 marginTop15">
                            <div class="height0 col gap5 alignStart  borderRadius10 bgSoft padding5"  id="workLabel"  style="display: none;">
                                <label for="">Work/Business</label>
                                <input type="text" id="work" name="work">
                            </div>
                            <div class="height0 col gap5 alignStart  borderRadius10 bgSoft padding5"  id="incomeLabel"  style="display: none;">
                                <label for="">Monthly Income</label>
                                <input type="number" id="monthlyIncome" name="monthlyIncome">
                            </div>
                        </div>
                        <br>
                        <div class="height0 gap5">
                            <div class="height0 col gap5 alignStart">
                                <label for="">Family Role</label>
                                <div class="selectBar widthMin100">
                                    <select name="rel" id="rel" required>
                                        <option value="" disabled selected>Select Role</option>
                                        
                                        <!-- Immediate Family -->
                                        <option value="Father">Father</option>
                                        <option value="Mother">Mother</option>
                                        <option value="Siblings">Siblings</option>
                                    
                                        <!-- Extended Family -->
                                        <option value="Grand Parent">Grand Parent</option>
                                    </select>
                                </div>
                            </div>
                            <br>
                            <div class="height0 col gap5 alignStart">
                                <label for="">Position</label>
                                <div class="selectBar widthMin100">
                                    <select name="position" id="position">
                                        <option value="Resident">Resident</option>
                                        <option value="Punong Barangay">Punong Barangay</option>
                                        <option value="Barangay Kagawad">Barangay Kagawad</option>
                                        <option value="Barangay Secretary">Barangay Secretary</option>
                                        <option value="Barangay Treasurer">Barangay Treasurer</option>
                                        <option value="Sk Chairman/Chairwoman">Sk Chairman/Chairwoman</option>
                                        <option value="Barangay BHW">Barangay BHW</option>
                                        <option value="Barangay BIC">Barangay BIC</option>
                                        <option value="Barangay BNS">Barangay BNS</option>
                                        <option value="Barangay BPO">Barangay BPO</option>
                                        <option value="Barangay Clerk">Barangay Clerk</option>
                                        <option value="Barangay DCW">Barangay DCW</option>
                                        <option value="Barangay Driver">Barangay Driver</option>
                                        <option value="Barangay Electrician">Barangay Electrician</option>
                                        <option value="Barangay Justice">Barangay Justice</option>
                                        <option value="Barangay Tanod">Barangay Tanod</option>
                                        <option value="Barangay Tanod-Chief">Barangay Tanod-Chief</option>
                                        <option value="Barangay Tanod-Deputy">Barangay Tanod-Deputy</option>
                                        <option value="Barangay Worker">Barangay Worker</option>
                                        <option value="BARC Chairman">BARC Chairman</option>
                                        <option value="Environment Officer">Environment Officer</option>
                                        <option value="Safety Officer">Safety Officer</option>
                                        <option value="Vawc Desk Officer">Vawc Desk Officer</option>  
                                    </select>
                                </div>
                            </div>
                        </div>
                        <br>
                        <div class="height0 justifyEnd"><button type="submit" class="nav pnav"><i class="fas fa-check-square"></i>Add to Record</button></div>
                    </div>
                </div>
            </form>
        </div>
        
        
    </div>
</div>

    <script>
        document.getElementById('bYear').addEventListener('input', validateAge);
        document.getElementById('bMonth').addEventListener('change', validateAge);
        document.getElementById('bDay').addEventListener('input', validateAge);
        document.getElementById('gender').addEventListener('change', togglePregnant);
        document.getElementById('employmentStatus').addEventListener('change', toggleEmploymentFields);
        document.getElementById('pwdCheckbox').addEventListener('change', function() {
            document.getElementById('pwdType').disabled = !this.checked;
        });
        
        function validateAge() {
            let bYear = parseInt(document.getElementById('bYear').value);
            let bMonth = parseInt(document.getElementById('bMonth').value);
            let bDay = parseInt(document.getElementById('bDay').value);
            let today = new Date();
            let birthDate = new Date(bYear, bMonth - 1, bDay);
            let age = today.getFullYear() - bYear;
            if (today.getMonth() < (bMonth - 1) || (today.getMonth() === (bMonth - 1) && today.getDate() < bDay)) {
                age--;
            }
            
            document.getElementById('ageWarning').style.display = age < 15 ? 'flex' : 'none';
        }
        
        function togglePregnant() {
            let gender = document.getElementById('gender').value;
            document.getElementById('pregnantLabel').style.display = gender === 'Female' ? 'flex' : 'none';
        }
        
        function toggleEmploymentFields() {
            let status = document.getElementById('employmentStatus').value;
            let workField = document.getElementById('work');
            let incomeField = document.getElementById('monthlyIncome');
            let workLabel = document.getElementById('workLabel');
            let incomeLabel = document.getElementById('incomeLabel');
            
            if (status === 'Unemployed') {
                workLabel.style.display = 'none';
                incomeLabel.style.display = 'none';
                workField.required = false;
                incomeField.required = false;
            } else {
                workLabel.style.display = 'inline';
                incomeLabel.style.display = 'inline';
                workField.required = true;
                incomeField.required = true;
            }
        }
    </script>
                
    <script>
        function enforceNumericInput(event) {
            event.target.value = event.target.value.replace(/[^0-9]/g, '').slice(0, 11);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const phoneInputs = document.querySelectorAll('.phone');
            phoneInputs.forEach(input => {
                input.addEventListener('input', enforceNumericInput);
            });
        });
    </script>
