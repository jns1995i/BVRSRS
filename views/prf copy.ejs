<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BVRSRS</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/color.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <link rel="stylesheet" href="/user.css">
    <link rel="icon" href="/images/logo.png">
    <style>
        .horizon {
        display: flex;
        overflow-x: auto;
        white-space: nowrap;
        gap: 20px;
        padding: 15px 0;
        justify-content: start;
        scroll-snap-type: x mandatory;
        border: 1px solid rgba(255, 255, 255, 0);
        border-radius: 10px;
        }
        .horCard {
            flex: 0 0 auto;
            padding: 20px;
            width: 23%;
        }
        .details {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.6s ease-in-out, opacity 0.8s ease-in-out, padding 0.4s ease-in-out;
            white-space: pre-line;
        }

        .details.show {
            max-height: fit-content;
            opacity: 1;
            padding: 10px 0;
        }

        .newsCard {
            transition: all 0.8s ease-in-out;
        }
        #assignDepCard {
            max-width: 0;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        #assignDepCard.active {
            max-width: 100%;
            max-height: 100%;
            opacity: 1;
            padding: 0;
            position: absolute;
            z-index: 500;
            top: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .unseen {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.9s ease, opacity 0.6s ease;
        }
        .seen {
            max-height: 300px;
            opacity: 1;
            padding: 0;
            transition: max-height 0.9s ease, opacity 0.6s ease;
        }
        textarea {
            background-color: white;
        }
        label {
            margin-top: 20px;
        }
        .headf {
            border: none;
        }
    </style>
<body class="block bgWhite">
    <div class="height100 block alignStart overflow-y1" id="assignDepCard" style="overflow-y: auto !important;">
        <div class="height100 padding20 justifyCenter alignCenter">
            <form action="/myUpdate" method="POST" class="flex bgSoft borderRadius20 col height0 padding40 gap10 width30 darkShadow relative">
                <a href="" class="nav cnav absolute right10 top10"><i class="fas fa-times"></i></a>
                <p class="size18 str500 green">Update Information</p>
                    <height0 class="gap5 col">
                        <label for="">Email</label>
                        <input type="text" class="bgWhite" value="<%= user.email %>" name="email">
                    </height0>
                    <height0 class="gap5 col">
                        <label for="">Contact No</label>
                        <input type="text" class="bgWhite" value="<%= user.phone %>" name="phone">
                    </height0>
                <div class="height0 justifyEnd"><button type="submit" class="nav fnav width0 bgGreen white border0">Update</button></div>
            </form>
        </div>
    </div>
    <div class="height95 gap20 bgSoft padding20 borderRadius10 alignStart">
        <div class="bgWhite borderRadius10 padding30 col alignStart justifyStart gap10 height0">
            <div class="height0 justifyBetween">
                <a href="/hom" class="nav headf" id=""><i class="fas fa-chevron-left"></i>Go Back</a>
                <a href="/" class="nav headf" id=""><i class="fas fa-sign-out"></i>Logout</a>
            </div>
            <div class="height0 alignStart col white gap10 padding20 abstractBG borderRadius10 relative">
                <img src="<%= user.photo || '/images/profile.jpg' %>" alt="" class="borderRadius500 borderPrimary h90 w90">
                <p class="size22 str400"><%= user.firstName %> <%= user.middleName %> <%= user.lastName %> <%= user.extName %></p>
            </div>
            <div class="height0 borderRadius10 padding10">
                <div class="height0 col">
                    <label for="" class="margin0 marginTop5">House Role</label>
                    <p class="size14 str500"><%= user.role %></p>
                </div>
                <div class="height0 col">
                    <label for="" class="margin0 marginTop5">Account Type</label>
                    <p class="size14 str500"><%= user.position %></p>
                </div>
            </div>
            <div class="bgSoft borderRadius10 height0 padding20 size12 textCenter">
                <p>
                    To ensure smooth communication and access to services, always keep your details up to date. You can update your photo, personal email and contact number anytime.
                    <br><br>
                    If thereâ€™s a mispelled or incorrect information, Let us know by filling out this ðŸ”— <a href="" class="inline str600">REQUEST FORM</a>
                    
                </p>
            </div>
            
            <div class="height0 gap20 justifyBetween">
                <a href="javascript:void()" class="nav tnav headf" id=""><i class="fas fa-camera"></i>Upload Photo</a>
                <a href="javascript:void()" class="nav tnav headf" id=""><i class="fas fa-key"></i>Password</a>
                <a href="javascript:void()" class="nav tnav headf" id="assignBtn"><i class="fas fa-edit"></i>Update Info</a>
            </div>

            <div class="height0 padding20 bgSoft borderRadius10 hidden">
                <form action="/resetMe" method="POST" class="col gap20 flex width100 height100 padding20 bgWhite borderRadius10 darkShadow">
                    <p class="size24 str500 colorPrimary">Reset Password</p>
                    <input type="hidden" name="userId" value="<%= user._id %>">
                    <input type="password" name="newPassword" placeholder="Enter new password" required>
                    <input type="password" name="confirmPassword" placeholder="Confirm new password" required>
                    <button type="submit" class="nav pnav fnav">RESET PASSWORD</button>
                </form>
            </div>
        </div>
        <div class="height0 bgWhite borderRadius10 padding30 col alignStart justifyStart">
            <div class="height0 col alignStart padding20">
                <label for="" class="margin0 marginTop5">Address</label>
                <p class="size14 str500"><%= household ? household.houseNo : 'N/A' %> <%= household ? household.purok : 'N/A' %></p>
                <label for="" class="margin0 marginTop5">Civil Status</label>
                <p class="size14 str500"><%= user.civilStatus %></p>
                <label for="" class="margin0 marginTop5">Gender</label>
                <p class="size14 str500"><%= user.gender %></p>
                <label for="" class="margin0 marginTop5">Birthday</label>
                <p class="size14 str500"><% const monthNames = [
                        "January", "February", "March", "April", "May", "June",
                        "July", "August", "September", "October", "November", "December"
                    ]; 
                    %>
                    <%= monthNames[user.bMonth - 1] %> <%= user.bDay %>, <%= user.bYear %>
                </p>
                <label for="" class="margin0 marginTop5">Birth Place</label>
                <p class="size14 str500"><%= user.birthPlace %></p>
                <label for="" class="margin0 marginTop5">Contact No.</label>
                <p class="size14 str500"><%= user.phone %></p>
                <label for="" class="margin0 marginTop5">Email</label>
                <p class="size14 str500"><%= user.email %></p>
            </div>
        </div>
        <div class="height0 bgWhite borderRadius10 padding30 col alignCenter justifyStart gap20">
            <div class="height0 padding20 abstractBG borderRadius10 textCenter size20 white">
                Your updated information helps us serve you better!
            </div>
            
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll(".showBtn").forEach(button => {
            button.addEventListener("click", function(event) {
                event.preventDefault(); // Prevent default <a> behavior
    
                let newsCard = this.closest(".newsCard"); // Get parent newsCard
                let details = newsCard.querySelector(".details"); // Get details inside the card
                let icon = this.querySelector("i"); // Get icon inside the button
    
                details.classList.toggle("show"); // Toggle visibility
                
                // Toggle icon class
                if (details.classList.contains("show")) {
                    icon.classList.remove("fa-chevron-down");
                    icon.classList.add("fa-chevron-up");
                } else {
                    icon.classList.remove("fa-chevron-up");
                    icon.classList.add("fa-chevron-down");
                }
            });
        });
    });
    
    </script>
<script>
    document.querySelectorAll('.details').forEach(div => {
    div.innerHTML = div.innerHTML.replace(/(?<!\S)(https?:\/\/[^\s]+|www\.[^\s]+|\b[a-zA-Z0-9.-]+\.(com|net|org|gov|edu|ph)\b)(?!\S)/g, '<a href="http://$1" target="_blank" class="inline blue str500">$1</a>');
});
</script>
<script>
document.getElementById("assignBtn").addEventListener("click", function (event) {
    event.preventDefault(); // Prevent default link behavior

    let assignCard = document.getElementById("assignDepCard");
    let assignBtn = document.getElementById("assignBtn");

    // Toggle 'active' class
    assignCard.classList.toggle("active");

    // Change button text & icon based on active state
    if (assignCard.classList.contains("active")) {
        assignBtn.innerHTML = '<i class="fas fa-edit"></i> Update Info';
    } else {
        assignBtn.innerHTML = '<i class="fas fa-edit"></i> Update Info';
    }
});

// Add logic to handle closing when closeBtn is clicked
document.getElementById("closeBtn").addEventListener("click", function () {
    let assignCard = document.getElementById("assignDepCard");
    let assignBtn = document.getElementById("assignBtn");

    // Remove 'active' class
    assignCard.classList.remove("active");

    // Reset button text & icon
    assignBtn.innerHTML = '<i class="fas fa-edit"></i> Update Info';
});

</script>
    
</body>
</html>